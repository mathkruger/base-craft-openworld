"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var CustomMap=function(){function t(){_classCallCheck(this,t),this.layers={layerOne:[],layerTwo:[],layerThree:[]},this.backgroundColor="#fff",this.nextMapUp="",this.nextMapDown="",this.nextMapLeft="",this.nextMapRight=""}return _createClass(t,[{key:"getMapFromJson",value:function(t){var e=this;return fetch("/maps/"+t+".json").then(function(t){return t.json()}).then(function(t){e.backgroundColor=t.backgroundColor,e.layers.layerOne=t.layers.layerOne,e.layers.layerTwo=t.layers.layerTwo,e.layers.layerThree=t.layers.layerThree,e.nextMapUp=t.nextMapUp,e.nextMapDown=t.nextMapDown,e.nextMapLeft=t.nextMapLeft,e.nextMapRight=t.nextMapRight})}}]),t}(),Inventory=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;_classCallCheck(this,t),this.items=e,this.capacity=n,this.selectedItem=0}return _createClass(t,[{key:"addItem",value:function(t){this.items.length<this.capacity&&this.items.push(t)}},{key:"useItem",value:function(){var t=this.items[this.selectedItem];t&&(t.action(),t.quantity-=1,t.quantity<=0&&this.items.splice(this.selectedItem,1))}}]),t}(),World=function(){function t(e,n,r,i,o){_classCallCheck(this,t),this.canvas=e,this.width=n,this.height=r,this.tileSize=i,this.fps=o,this.lastTime=null,this.requiredElapsed=1e3/this.fps,this.elements=[],this.inventoryElements=[],this.renderer=new Renderer(e,this.elements),this.player=null,this.map=new CustomMap}return _createClass(t,[{key:"loop",value:function(t){var e=this;requestAnimationFrame(function(t){e.loop(t)}),this.lastTime||(this.lastTime=t),this.lastTime+t>this.requiredElapsed&&(this.update(),this.lastTime=t)}},{key:"start",value:function(){var t=this;this.selectMap("grassCity/map1",function(){requestAnimationFrame(function(e){t.loop(e)})})}},{key:"input",value:function(){this.player.input(),this.player.inventoryInput()}},{key:"update",value:function(){this.player.isInventoryOpen||(this.player.move(),this.player.checkCollision(this.elements),this.player.checkOutBoundaries()),this.renderer.render()}},{key:"nextMap",value:function(t){switch(t){case"up":this.player.y=this.height*this.tileSize-this.player.height,this.selectMap(this.map.nextMapUp);break;case"right":this.player.x=this.tileSize,this.selectMap(this.map.nextMapRight);break;case"down":this.player.y=this.tileSize,this.selectMap(this.map.nextMapDown);break;case"left":this.player.x=this.width*this.tileSize-this.player.width,this.selectMap(this.map.nextMapLeft)}}},{key:"selectMap",value:function(t,e){var n=this;this.elements=[],this.canvas.width=this.width*this.tileSize,this.canvas.height=this.height*this.tileSize,this.map.getMapFromJson(t).then(function(){n.createMap(),n.input(),n.renderer.stack=n.elements,n.player.isWrapping=!1,e&&e()})}},{key:"createMap",value:function(){var t=this,e={player:[new Sprite(0,0,this.tileSize,this.tileSize,"player-down"),new Sprite(0,0,this.tileSize,this.tileSize,"player-left"),new Sprite(0,0,this.tileSize,this.tileSize,"player-right"),new Sprite(0,0,this.tileSize,this.tileSize,"player-up")],grass:new Sprite(0,0,this.tileSize,this.tileSize,"grass"),tree:new Sprite(0,0,this.tileSize,this.tileSize,"tree")},n={healthPotion:function(e,n){return new HealthPotion(e,n,t.tileSize,t.tileSize,function(){console.log("Yumyyyy")})},sword:function(e,n){return new Sword(e,n,t.tileSize,t.tileSize,function(){t.player.slots.tool=t.player.inventory.items[t.player.inventory.selectedItem]})}};this.elements.push(new Entity(0,0,this.height*this.tileSize,this.width*this.tileSize,this.map.backgroundColor,0,"rect")),Object.keys(this.map.layers).forEach(function(r){for(var i=0;i<t.width*t.tileSize;i+=t.tileSize)for(var o=0;o<t.height*t.tileSize;o+=t.tileSize){var s=i/t.tileSize,a=o/t.tileSize;switch(t.map.layers[r][a][s]){case"P":t.player||(t.player=new PlayerEntity(s*t.tileSize,a*t.tileSize,t.tileSize,t.tileSize,"",5,"sprite",e.player,t)),t.elements.push(t.player);break;case"G":t.elements.push(new Entity(i,o,t.tileSize,t.tileSize,"",0,"sprite",e.grass));break;case"T":t.elements.push(new Entity(i,o,t.tileSize,t.tileSize,"",0,"sprite",e.tree,!0));break;case"H":t.elements.push(n.healthPotion(i,o));break;case"S":t.elements.push(n.sword(i,o))}}})}},{key:"updateInventory",value:function(){this.destroyInventory(),this.createInventory()}},{key:"createInventory",value:function(){var t,e=this,n=this.player.inventory.items.reduce(function(t,e){return t+e.height},0)+4*this.tileSize,r=new Entity(3*this.tileSize,3*this.tileSize,n,4*this.tileSize,"#444444",0,"rect"),i=new Entity(r.x+r.width,r.y,40,2*this.tileSize,"#444444",0,"rect");this.inventoryElements.push(r),this.inventoryElements.push(i),this.player.inventory.items.forEach(function(t,n){t.x=r.x+5,t.y=r.y+n*e.tileSize+5,e.inventoryElements.push(new TextEntity(t.x+t.width,t.y+t.height/2,e.player.inventory.selectedItem===n?"red":"white","12px serif",t.name+" x"+t.quantity)),e.inventoryElements.push(t)}),this.inventoryElements.push(new TextEntity(i.x+5,i.y+5,"red","12px serif",this.player.slots.tool.name)),(t=this.elements).push.apply(t,_toConsumableArray(this.inventoryElements)),this.renderer.render()}},{key:"destroyInventory",value:function(){var t=this;this.inventoryElements.forEach(function(e,n){t.elements.includes(e)&&t.elements.splice(t.elements.findIndex(function(t){return t===e}),1)}),this.inventoryElements=[],this.renderer.render()}}]),t}(),Entity=function(){function t(e,n,r,i,o,s){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"rect",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];_classCallCheck(this,t),this.x=e,this.y=n,this.height=r,this.width=i,this.color=o,this.speed=s,this.renderMode=a,this.sprite=l,this.isSolid=c}return _createClass(t,[{key:"move",value:function(t){}},{key:"checkCollision",value:function(t){}}]),t}(),Item=function(t){function e(t,r,i,o,s,a,l,c,u,f,h,p,y){var d;return _classCallCheck(this,e),d=n.call(this,t,r,i,o,s,a,l,c,u),d.id=f,d.name=h,d.quantity=p,d.action=y||function(){},d}_inherits(e,t);var n=_createSuper(e);return e}(Entity),PlayerEntity=function(t){function e(t,r,i,o,s,a,l,c){var u,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;return _classCallCheck(this,e),u=n.call(this,t,r,i,o,s,a,l),u.sprites=c,u.sprite=u.sprites[0],u.world=f,u.isMoving=!1,u.lastDirection="s",u.collideDirection="",u.isSolid=!0,u.isWrapping=!1,u.isInventoryOpen=!1,u.inventory=new Inventory([],10),u.slots={tool:new Entity},u.isUsingTool=!1,u}_inherits(e,t);var n=_createSuper(e);return _createClass(e,[{key:"input",value:function(){var t=this;document.addEventListener("keypress",function(e){["a","s","w","d"].includes(e.key.toLowerCase())?e.key.toLowerCase()!==t.collideDirection&&(t.isMoving=!0,t.lastDirection=e.key.toLowerCase()):"i"===e.key.toLowerCase()?t.toggleInventory():" "===e.key.toLowerCase()&&t.useTool()}),document.addEventListener("keyup",function(e){t.isMoving=!1})}},{key:"inventoryInput",value:function(){var t=this;document.addEventListener("keydown",function(e){if(t.isInventoryOpen&&["w","s","enter"].includes(e.key.toLocaleLowerCase())){switch(e.key.toLowerCase()){case"w":t.inventory.selectedItem=0==t.inventory.selectedItem?0:t.inventory.selectedItem-1;break;case"s":t.inventory.selectedItem=t.inventory.selectedItem==t.inventory.items.length-1?t.inventory.selectedItem:t.inventory.selectedItem+1;break;case"enter":t.inventory.useItem()}t.world.updateInventory()}})}},{key:"toggleInventory",value:function(){this.isInventoryOpen=!this.isInventoryOpen,this.inventory.selectedItem=0,this.isInventoryOpen?this.world.createInventory():this.world.destroyInventory()}},{key:"useTool",value:function(){var t=this;switch(this.lastDirection){case"w":this.slots.tool.x=this.x,this.slots.tool.y=this.y-this.height-10;break;case"s":this.slots.tool.x=this.x,this.slots.tool.y=this.y+this.height+10;break;case"a":this.slots.tool.y=this.y,this.slots.tool.x=this.x-this.width-10;break;case"d":this.slots.tool.y=this.y,this.slots.tool.x=this.x+this.width+10}this.isUsingTool=!0,this.world.elements.push(this.slots.tool),setTimeout(function(){t.world.elements.splice(t.world.elements.findIndex(function(e){return e===t.slots.tool}),1),t.isUsingTool=!1},300)}},{key:"move",value:function(){this.isMoving&&("s"===this.lastDirection&&(this.y+=this.speed,this.sprite=this.sprites[0]),"a"===this.lastDirection&&(this.x-=this.speed,this.sprite=this.sprites[1]),"d"===this.lastDirection&&(this.x+=this.speed,this.sprite=this.sprites[2]),"w"===this.lastDirection&&(this.y-=this.speed,this.sprite=this.sprites[3]))}},{key:"checkOutBoundaries",value:function(){this.isWrapping||(this.x>this.world.width*this.world.tileSize?(this.world.nextMap("right"),this.isWrapping=!0):this.x+this.width<0?(this.world.nextMap("left"),this.isWrapping=!0):this.y>this.world.height*this.world.tileSize?(this.world.nextMap("down"),this.isWrapping=!0):this.y+this.height<0&&(this.world.nextMap("up"),this.isWrapping=!0))}},{key:"checkCollision",value:function(t){var e=this,n=t.find(function(t){return t!==e&&t.isSolid&&e.x<t.x+t.width-5&&e.x+e.width>t.x&&e.y<t.y+t.height-5&&e.y+e.height>t.y});n?n instanceof Item&&!this.isUsingTool?(this.inventory.addItem(n),t.splice(t.findIndex(function(t){return t===n}),1)):(this.isMoving=!1,this.collideDirection=this.lastDirection,"s"===this.lastDirection&&(this.y-=this.speed),"a"===this.lastDirection&&(this.x+=this.speed),"d"===this.lastDirection&&(this.x-=this.speed),"w"===this.lastDirection&&(this.y+=this.speed)):this.collideDirection=""}}]),e}(Entity),TextEntity=function(t){function e(t,r,i,o,s){var a;return _classCallCheck(this,e),a=n.call(this,t,r,0,0,i,0,"text",null,!1),a.font=o,a.text=s,a}_inherits(e,t);var n=_createSuper(e);return e}(Entity),Renderer=function(){function t(e,n){_classCallCheck(this,t),this.canvas=e,this.context=e.getContext("2d"),this.stack=n}return _createClass(t,[{key:"render",value:function(){var t=this;this.clearScreen(),this.stack.forEach(function(e){switch(e.renderMode){default:case"rect":t.createRect(e);break;case"circle":t.createCircle(e);break;case"sprite":t.createImage(e);break;case"text":t.createText(e)}})}},{key:"createRect",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.color;this.context.fillStyle=o,this.context.fillRect(e,n,r,i)}},{key:"createCircle",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.color;this.context.fillStyle=i,this.context.beginPath(),this.context.arc(e,n,r,0,2*Math.PI),this.context.fill()}},{key:"createImage",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.sprite,s=document.getElementById(o.id);this.context.drawImage(s,e,n,r,i)}},{key:"createText",value:function(t){var e=t.x,n=t.y,r=t.color,i=t.font,o=t.text;this.context.font=i,this.context.fillStyle=r,this.context.fillText(o,e,n)}},{key:"clearScreen",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.screenWidth,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.screenHeight;this.context.clearRect(t,e,n,r)}}]),t}(),Sprite=function t(e,n,r,i,o,s){_classCallCheck(this,t),this.tileX=e,this.tileY=n,this.width=r,this.height=i,this.id=o,this.mapChar=s},HealthPotion=function(t){function e(t,r,i,o,s){return _classCallCheck(this,e),n.call(this,t,r,i,o,"",0,"sprite",new Sprite(0,0,o,i,"potion"),!0,2,"Health Potion",1,s)}_inherits(e,t);var n=_createSuper(e);return e}(Item),Sword=function(t){function e(t,r,i,o,s){return _classCallCheck(this,e),n.call(this,t,r,i,o,"",0,"sprite",new Sprite(0,0,o,i,"sword"),!0,1,"Sword",1,s)}_inherits(e,t);var n=_createSuper(e);return e}(Item),FPS=60,canvas=document.getElementById("main-game"),tileSize=48,width=15,height=10,world=new World(canvas,width,height,tileSize,FPS);world.start();